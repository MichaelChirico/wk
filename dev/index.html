<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lightweight Well-Known Geometry Parsing • wk</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Lightweight Well-Known Geometry Parsing">
<meta property="og:description" content="Provides a minimal R and C++ API for parsing
  well-known binary and well-known text representation of
  geometries to and from R-native formats. 
  Well-known binary is compact
  and fast to parse; well-known text is human-readable
  and is useful for writing tests. These formats are only
  useful in R if the information they contain can be 
  accessed in R, for which high-performance functions 
  are provided here.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">wk</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paleolimbot/wk/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="wk" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#wk" class="anchor"></a>wk</h1></div>
<!-- badges: start -->

<p>The goal of wk is to provide lightweight R and C++ infrastructure for packages to use well-known formats (well-known binary and well-known text) as input and/or output without requiring external software. Well-known binary is very fast to read and write, whereas well-known text is human-readable and human-writable. Together, these formats allow for efficient interchange between software packages (WKB), and highly readable tests and examples (WKT).</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("remotes")</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"paleolimbot/wk"</span>)</pre></div>
<p>If you can load the package, you’re good to go!</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">wk</span>)</pre></div>
</div>
<div id="basic-vector-classes-for-wkt-and-wkb" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-vector-classes-for-wkt-and-wkb" class="anchor"></a>Basic vector classes for WKT and WKB</h2>
<p>Use <code><a href="reference/wkt.html">wkt()</a></code> to mark a character vector as containing well-known text, or <code><a href="reference/wkb.html">wkb()</a></code> to mark a vector as well-known binary. These have some basic vector features built in, which means you can subset, repeat, concatenate, and put these objects in a data frame or tibble. These come with built-in <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> and <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> methods.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="reference/wkt.html">wkt</a></span>(<span class="st">"POINT (30 10)"</span>)
<span class="co">#&gt; &lt;wk_wkt[1]&gt;</span>
<span class="co">#&gt; [1] POINT (30 10)</span>
<span class="fu"><a href="reference/wkb.html">as_wkb</a></span>(<span class="fu"><a href="reference/wkt.html">wkt</a></span>(<span class="st">"POINT (30 10)"</span>))
<span class="co">#&gt; &lt;wk_wkb[1]&gt;</span>
<span class="co">#&gt; [1] &lt;POINT (30 10)&gt;</span></pre></div>
</div>
<div id="extract-coordinates-and-meta-information" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-coordinates-and-meta-information" class="anchor"></a>Extract coordinates and meta information</h2>
<p>One of the main drawbacks to passing around geomtries in WKB is that the format is opaque to R users, who need coordinates as R object rather than binary vectors. In addition to <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> and <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> methods for <code><a href="reference/wkb.html">wkb()</a></code> vectors, the <code>wk*_meta()</code> and <code>wk*_coords()</code> functions provide usable coordinates and feature meta.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="reference/wkb_coords.html">wkt_coords</a></span>(<span class="st">"POINT ZM (1 2 3 4)"</span>)
<span class="co">#&gt;   feature_id part_id ring_id x y z m</span>
<span class="co">#&gt; 1          1       1       0 1 2 3 4</span>
<span class="fu"><a href="reference/wkb_meta.html">wkt_meta</a></span>(<span class="st">"POINT ZM (1 2 3 4)"</span>)
<span class="co">#&gt;   feature_id part_id type_id size srid has_z has_m n_coords</span>
<span class="co">#&gt; 1          1       1       1    1   NA  TRUE  TRUE        1</span></pre></div>
</div>
<div id="well-known-r-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#well-known-r-objects" class="anchor"></a>Well-known R objects?</h2>
<p>The wk package experimentally generates (and parses) well-known “s” expressions (the C name for R objects). This is similar to the format that <a href="https://r-spatial.github.io/sf">sf</a> uses.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="reference/wkb_translate_wkt.html">wkt_translate_wksxp</a></span>(<span class="st">"POINT (30 10)"</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   30   10</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "wk_point"</span></pre></div>
</div>
<div id="dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#dependencies" class="anchor"></a>Dependencies</h2>
<p>The wk package imports <a href="https://cran.r-project.org/package=Rcpp">Rcpp</a>.</p>
</div>
<div id="using-the-c-headers" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-c-headers" class="anchor"></a>Using the C++ headers</h2>
<p>The wk package takes an event-based approach to parsing inspired by the event-based SAX XML parser. This makes the readers and writers highly re-usable! This system is class-based, so you will have to make your own subclass of <code>WKGeometryHandler</code> and wire it up to a <code>WKReader</code> to do anything useful.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">// If you're writing code in a package, you'll also</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">// have to put 'wk' in your `LinkingTo:` description field</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// [[Rcpp::depends(wk)]]</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="pp">#include </span><span class="im">"wk/rcpp-io.h"</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="pp">#include </span><span class="im">"wk/wkt-reader.h"</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw">class</span> CustomHandler: <span class="kw">public</span> WKGeometryHandler {</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="kw">public</span>:</span>
<span id="cb6-12"><a href="#cb6-12"></a>  </span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="dt">void</span> nextFeatureStart(<span class="dt">size_t</span> featureId) {</span>
<span id="cb6-14"><a href="#cb6-14"></a>    Rcout &lt;&lt; <span class="st">"Do something before feature "</span> &lt;&lt; featureId &lt;&lt; <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>;</span>
<span id="cb6-15"><a href="#cb6-15"></a>  }</span>
<span id="cb6-16"><a href="#cb6-16"></a>  </span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="dt">void</span> nextFeatureEnd(<span class="dt">size_t</span> featureId) {</span>
<span id="cb6-18"><a href="#cb6-18"></a>    Rcout &lt;&lt; <span class="st">"Do something after feature "</span> &lt;&lt; featureId &lt;&lt; <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>;</span>
<span id="cb6-19"><a href="#cb6-19"></a>  }</span>
<span id="cb6-20"><a href="#cb6-20"></a>};</span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="dt">void</span> wkt_read_custom(CharacterVector wkt) {</span>
<span id="cb6-24"><a href="#cb6-24"></a>  WKCharacterVectorProvider provider(wkt);</span>
<span id="cb6-25"><a href="#cb6-25"></a>  WKTReader reader(provider);</span>
<span id="cb6-26"><a href="#cb6-26"></a>  </span>
<span id="cb6-27"><a href="#cb6-27"></a>  CustomHandler handler;</span>
<span id="cb6-28"><a href="#cb6-28"></a>  reader.setHandler(&amp;handler);</span>
<span id="cb6-29"><a href="#cb6-29"></a>  </span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="cf">while</span> (reader.hasNextFeature()) {</span>
<span id="cb6-31"><a href="#cb6-31"></a>    reader.iterateFeature();</span>
<span id="cb6-32"><a href="#cb6-32"></a>  }</span>
<span id="cb6-33"><a href="#cb6-33"></a>}</span></code></pre></div>
<p>On our example point, this prints the following:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu">wkt_read_custom</span>(<span class="st">"POINT (30 10)"</span>)
<span class="co">#&gt; Do something before feature 0</span>
<span class="co">#&gt; Do something after feature 0</span></pre></div>
<p>The full handler interface includes methods for the start and end of features, geometries (which may be nested), linear rings, coordinates, and parse errors. You can preview what will get called for a given geometry using <code>wkb|wkt_debug()</code> functions.</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu"><a href="reference/wkb_debug.html">wkt_debug</a></span>(<span class="st">"POINT (30 10)"</span>)
<span class="co">#&gt; nextFeatureStart(0)</span>
<span class="co">#&gt;     nextGeometryStart(POINT [1], WKReader::PART_ID_NONE)</span>
<span class="co">#&gt;         nextCoordinate(POINT [1], WKCoord(x = 30, y = 10), 0)</span>
<span class="co">#&gt;     nextGeometryEnd(POINT [1], WKReader::PART_ID_NONE)</span>
<span class="co">#&gt; nextFeatureEnd(0)</span></pre></div>
</div>
<div id="performance" class="section level2">
<h2 class="hasAnchor">
<a href="#performance" class="anchor"></a>Performance</h2>
<p>This package was designed to stand alone and be flexible, but also happens to be really fast for some common operations.</p>
<p>Read WKB + Write WKB:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">:::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wksxp_translate_wkb</a></span>(<span class="kw pkg">wk</span><span class="kw ns">:::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wkb_translate_wksxp</a></span>(<span class="no">nc_wkb</span>)),
  <span class="kw">geos_c</span> <span class="kw">=</span> <span class="kw pkg">geovctrs</span><span class="kw ns">:::</span><span class="fu">geovctrs_cpp_convert</span>(<span class="no">nc_wkb</span>, <span class="no">wkb_ptype</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">CPL_read_wkb</span>(<span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">CPL_write_wkb</span>(<span class="no">nc_sfc</span>, <span class="kw">EWKB</span> <span class="kw">=</span> <span class="fl">TRUE</span>), <span class="kw">EWKB</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; # A tibble: 3 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk            273µs    333µs     2966.   114.2KB    18.1 </span>
<span class="co">#&gt; 2 geos_c        498µs    551µs     1780.    53.5KB     2.03</span>
<span class="co">#&gt; 3 sf            370µs    413µs     2338.    99.8KB    16.6</span></pre></div>
<p>Read WKB + Write WKT:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">:::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wkb_translate_wkt</a></span>(<span class="no">nc_wkb</span>),
  <span class="kw">geos_c</span> <span class="kw">=</span> <span class="kw pkg">geovctrs</span><span class="kw ns">:::</span><span class="fu">geovctrs_cpp_convert</span>(<span class="no">nc_wkb</span>, <span class="no">wkt_ptype</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">st_as_text.sfc</span>(<span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">st_as_sfc.WKB</span>(<span class="no">nc_WKB</span>, <span class="kw">EWKB</span> <span class="kw">=</span> <span class="fl">TRUE</span>)),
  <span class="kw">wellknown</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nc_wkb</span>, <span class="kw pkg">wellknown</span><span class="kw ns">::</span><span class="no">wkb_wkt</span>),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; Warning: Some expressions had a GC in every iteration; so filtering is</span>
<span class="co">#&gt; disabled.</span>
<span class="co">#&gt; # A tibble: 4 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk           3.03ms   3.22ms    308.      3.32KB     0   </span>
<span class="co">#&gt; 2 geos_c          4ms   4.36ms    228.      3.32KB     0   </span>
<span class="co">#&gt; 3 sf         180.12ms  184.4ms      5.28  569.81KB    21.1 </span>
<span class="co">#&gt; 4 wellknown   25.42ms  28.76ms     33.4     3.41MB     5.89</span></pre></div>
<p>Read WKT + Write WKB:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">:::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wkt_translate_wkb</a></span>(<span class="no">nc_wkt</span>),
  <span class="kw">geos_c</span> <span class="kw">=</span> <span class="kw pkg">geovctrs</span><span class="kw ns">:::</span><span class="fu">geovctrs_cpp_convert</span>(<span class="no">nc_wkt</span>, <span class="no">wkb_ptype</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">CPL_write_wkb</span>(<span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">st_as_sfc.character</span>(<span class="no">nc_wkt</span>), <span class="kw">EWKB</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">wellknown</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nc_wkt</span>, <span class="kw pkg">wellknown</span><span class="kw ns">::</span><span class="no">wkt_wkb</span>),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; # A tibble: 4 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk           1.89ms   2.02ms     492.    53.58KB     0   </span>
<span class="co">#&gt; 2 geos_c        2.5ms   2.73ms     362.    49.48KB     0   </span>
<span class="co">#&gt; 3 sf           3.32ms   3.58ms     274.   186.48KB     6.41</span>
<span class="co">#&gt; 4 wellknown   42.73ms  45.88ms      21.9    1.31MB    12.5</span></pre></div>
<p>Read WKT + Write WKT:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wksxp_translate_wkt</a></span>(<span class="kw pkg">wk</span><span class="kw ns">::</span><span class="fu"><a href="reference/wkb_translate_wkt.html">wkt_translate_wksxp</a></span>(<span class="no">nc_wkt</span>)),
  <span class="kw">geos_c</span> <span class="kw">=</span> <span class="kw pkg">geovctrs</span><span class="kw ns">:::</span><span class="fu">geovctrs_cpp_convert</span>(<span class="no">nc_wkt</span>, <span class="no">wkt_ptype</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">st_as_text.sfc</span>(<span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">st_as_sfc.character</span>(<span class="no">nc_wkt</span>)),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; Warning: Some expressions had a GC in every iteration; so filtering is</span>
<span class="co">#&gt; disabled.</span>
<span class="co">#&gt; # A tibble: 3 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk           5.03ms   5.49ms    178.     63.77KB      0  </span>
<span class="co">#&gt; 2 geos_c       5.99ms   6.34ms    156.      3.32KB      0  </span>
<span class="co">#&gt; 3 sf         188.41ms 190.96ms      5.23  230.73KB     20.9</span></pre></div>
<p>Generate coordinates:</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk_wkb</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">::</span><span class="fu"><a href="reference/wkb_coords.html">wksxp_coords</a></span>(<span class="no">nc_sxp</span>),
  <span class="kw">sfheaders</span> <span class="kw">=</span> <span class="kw pkg">sfheaders</span><span class="kw ns">::</span><span class="fu">sfc_to_df</span>(<span class="no">nc_sfc</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu">st_coordinates</span>(<span class="no">nc_sfc</span>),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; # A tibble: 3 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk_wkb     160.84µs  185.1µs     5010.     131KB     29.9</span>
<span class="co">#&gt; 2 sfheaders  502.16µs 544.86µs     1772.     612KB     56.1</span>
<span class="co">#&gt; 3 sf           2.13ms   2.32ms      426.     606KB     33.7</span></pre></div>
<p>Send polygons to a graphics device (note that the graphics device is the main holdup in real life):</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="kw pkg">devoid</span><span class="kw ns">::</span><span class="fu">void_dev</span>()
<span class="fu"><a href="reference/wkb_draw_points.html">wksxp_plot_new</a></span>(<span class="no">nc_sxp</span>)

<span class="kw pkg">bench</span><span class="kw ns">::</span><span class="fu">mark</span>(
  <span class="kw">wk_wkb</span> <span class="kw">=</span> <span class="kw pkg">wk</span><span class="kw ns">::</span><span class="fu"><a href="reference/wkb_draw_points.html">wksxp_draw_polypath</a></span>(<span class="no">nc_sxp</span>),
  <span class="kw">sf</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">:::</span><span class="fu">plot.sfc_MULTIPOLYGON</span>(<span class="no">nc_sfc</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">check</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span>
<span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 wk_wkb      312.7µs  336.4µs     2769.     358KB     18.2</span>
<span class="co">#&gt; 2 sf           3.25ms   3.44ms      283.     241KB     20.7</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
<span class="co">#&gt; quartz_off_screen </span>
<span class="co">#&gt;                 2</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=wk">https://​cloud.r-project.org/​package=wk</a>
</li>
<li>Browse source code at <br><a href="https://github.com/paleolimbot/wk/">https://​github.com/​paleolimbot/​wk/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/paleolimbot/wk/issues">https://​github.com/​paleolimbot/​wk/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>LGPL (&gt;= 2.1)</small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dewey Dunnington <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9415-4582" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Edzer Pebesma <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8049-7069" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/paleolimbot/wk/actions"><img src="https://github.com/paleolimbot/wk/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/paleolimbot/wk?branch=master"><img src="https://codecov.io/gh/paleolimbot/wk/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dewey Dunnington, Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
